(this.webpackJsonpmy_react_app=this.webpackJsonpmy_react_app||[]).push([[0],{152:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),l=a.n(c),o=(a(96),a(74)),i=a(75),s=a(88),u=a(86),m=(a(97),a(98),a(54)),d=a(23),h=a(28),f=a.n(h),p=a(40),g=a(7),E=a(162),b=a(78),y=Object(n.createContext)({}),v=function(e){var t=e.children,a=Object(n.useState)({loading:!0,data:null}),c=Object(g.a)(a,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){o({loading:!1,data:JSON.parse(window.localStorage.getItem("authData"))})}),[]),Object(n.useEffect)((function(){window.localStorage.setItem("authData",JSON.stringify(l.data))}),[l.data]),r.a.createElement(y.Provider,{value:{auth:l,setAuthData:function(e){o({data:e})}}},t)},O="https://app.baomoi.press/wp-json/wp/v2/",j=a(11),w=a.n(j),C=function(e){var t=e.history,a=Object(n.useState)(),c=Object(g.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(),s=Object(g.a)(i,2),u=s[0],m=s[1],d=Object(n.useContext)(y).setAuthData,h=function(){var e=Object(p.a)(f.a.mark((function e(a){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,v();case 3:if(n=e.sent,r=null,!n){e.next=9;break}return e.next=8,j(n);case 8:r=e.sent;case 9:r&&(d({username:l}),t.replace("/"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){return w.a.post("https://app.baomoi.press/wp-json/jwt-auth/v1/token",{username:l,password:u}).then((function(e){return e.data.token})).catch((function(e){alert("Username or password is invalid!")}))},j=function(e){return w()({method:"GET",url:O+"current_user",headers:{Authorization:"Bearer "+e}}).then((function(e){return"administrator"===e.data.roles[0]||(alert("You are not allowed to access"),!1)})).catch((function(e){return!1}))};return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:400}},r.a.createElement("h2",{className:"text-center"},"B\xe1o m\u1edbi Press Notification"),r.a.createElement("h4",{className:"text-center"},"\u0110\u0103ng nh\u1eadp"),r.a.createElement(E.a,{onSubmit:h},r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Username"),r.a.createElement(E.a.Control,{type:"username",placeholder:"Enter username",onChange:function(e){o(e.target.value)}})),r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Password"),r.a.createElement(E.a.Control,{type:"password",placeholder:"Password",onChange:function(e){m(e.target.value)}})),r.a.createElement(b.a,{variant:"primary",type:"submit",className:"w-100 mt-3"},"Sign In as Admin"))))},S=function(e){var t=e.history,a=Object(n.useContext)(y),c=a.setAuthData,l=a.auth;return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Hello, ".concat(l.data.username)," "),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-sender")}},"G\u1eedi th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-cron")}},"Cron th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-5",onClick:function(){c(null)}},"Log out")))},k=(a(58),a(158)),x=a(77),N=a(159),D=a(48),R=a(160),T=a(161),L=a(164),I=a(79),_=a.n(I),G=a(80),q=a.n(G),B=(a(146),function(e){var t=e.history,a=Object(n.useState)(),c=Object(g.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(),s=Object(g.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(),h=Object(g.a)(d,2),f=h[0],p=h[1],y=Object(n.useState)(),v=Object(g.a)(y,2),j=v[0],C=v[1],S=Object(n.useState)(),I=Object(g.a)(S,2),G=I[0],B=I[1],K=Object(n.useState)(),P=Object(g.a)(K,2),W=P[0],A=P[1],H=Object(n.useState)(),M=Object(g.a)(H,2),J=M[0],U=M[1],F=Object(n.useState)([]),z=Object(g.a)(F,2),Q=z[0],Y=z[1],X=Object(n.useState)(),$=Object(g.a)(X,2),V=$[0],Z=$[1],ee=Object(n.useState)(),te=Object(g.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(0),ce=Object(g.a)(re,2),le=ce[0],oe=ce[1],ie=Object(n.useState)(!1),se=Object(g.a)(ie,2),ue=se[0],me=se[1],de=Object(n.useState)(),he=Object(g.a)(de,2),fe=he[0],pe=he[1],ge=Object(n.useState)(0),Ee=Object(g.a)(ge,2),be=Ee[0],ye=Ee[1],ve=Object(n.useState)(),Oe=Object(g.a)(ve,2),je=Oe[0],we=Oe[1],Ce=Object(n.useState)(new Date),Se=Object(g.a)(Ce,2),ke=Se[0],xe=Se[1],Ne=Object(n.useState)("* * * * * * *"),De=Object(g.a)(Ne,2),Re=De[0],Te=De[1],Le=Object(n.useState)(!1),Ie=Object(g.a)(Le,2),_e=Ie[0],Ge=Ie[1],qe=Object(n.useRef)(!0);Object(n.useEffect)((function(){Be()}),[]),Object(n.useLayoutEffect)((function(){qe.current?qe.current=!1:(me(!0),Pe())}),[V,J,ae]);var Be=function(){w()({method:"GET",url:O+"get_hobby_choices"}).then((function(e){Y(e.data)})).catch((function(e){return console.log(e)}))},Ke=function(e){B(e.target.id)},Pe=function(){var e="",t="",a="",n=0;J&&(e="&filter[meta_query]["+n+"][key]=gender&filter[meta_query]["+n+"][value]="+J.toString(),n++),V&&(t="&filter[meta_query]["+n+"][key]=so_thich&filter[meta_query]["+n+"][value]="+V.toString(),n++),ae&&(a=(a="&filter[meta_query]["+n+"][key]=age&filter[meta_query]["+n+"][value]="+ae.split("-")[0]+"&filter[meta_query]["+n+"][compare]=>")+"&filter[meta_query]["+ ++n+"][key]=age&filter[meta_query]["+n+"][value]="+ae.split("-")[1]+"&filter[meta_query]["+n+"][compare]=<="),pe(e+t+a),w.a.get("https://app.baomoi.press/wp-json/wp/v2/users?per_page=1"+e+t+a).then((function(e){oe(e.headers["x-wp-total"]),me(!1)})).catch((function(e){console.log(e)}))},We=function(e,t){var a={title:l,body:u,slug:j,image:f},n={scheduleOption:je,scheduleDateTime:ke,scheduleRecurringExpression:Re},r={recipientOption:G,singleFCMToken:W,filterQuery:fe};console.log(JSON.stringify({notificationData:a,scheduleData:n,recipientData:r})),w.a.post("/fcm-schedule-sender",{notificationData:a,scheduleData:n,recipientData:r,action:"createPlan"}).then((function(e){console.log(e.data),ye(0)})).catch((function(e){return console.log(e)}))},Ae=function(e){we(e.target.id),"recurring"===e.target.id&&Ge(!0)};return r.a.createElement("div",{style:{height:"100vh",marginTop:10},className:"d-flex flex-row justify-content-center align-items-center"},r.a.createElement("div",{style:{position:"absolute",top:20,right:20}},r.a.createElement(b.a,{variant:"link",onClick:function(){t.push("/schedule-history")}},"L\u1ecbch s\u1eed k\u1ebf ho\u1ea1ch >>")),r.a.createElement("div",{style:{height:350,width:320,marginRight:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement(E.a,null,r.a.createElement(E.a.Group,{as:k.a,controlId:"formTitle"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Title"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Control,{required:!0,type:"text",placeholder:"Title",onChange:function(e){return o(e.target.value)}}))),r.a.createElement(E.a.Group,{controlId:"formBody"},r.a.createElement(E.a.Label,null,"Body"),r.a.createElement(E.a.Control,{required:!0,as:"textarea",rows:"3",placeholder:"Body",onChange:function(e){return m(e.target.value)}})),r.a.createElement(E.a.Group,{as:k.a,controlId:"formImageURL"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Image"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Image Url(not required)",onChange:function(e){return p(e.target.value)}}))),r.a.createElement(E.a.Group,{as:k.a,controlId:"formSlugData"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Slug"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Slug Data(not required)",onChange:function(e){return C(e.target.value)}}))))),r.a.createElement("div",{style:{height:350,width:320,marginHorizontal:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement("fieldset",null,r.a.createElement(E.a.Group,{as:k.a},r.a.createElement(E.a.Label,{as:"legend",column:!0,sm:2},"G\u1eedi cho"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Check,{type:"radio",label:"M\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"singleRecipient",onChange:Ke}),r.a.createElement(E.a.Check,{type:"radio",label:"Nh\xf3m \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"filterRecipients",onChange:Ke}),r.a.createElement(E.a.Check,{type:"radio",label:"T\u1ea5t c\u1ea3",name:"recipientOption",id:"allRecipients",onChange:Ke})))),"singleRecipient"===G&&r.a.createElement(E.a,null,r.a.createElement(E.a.Group,{as:k.a,controlId:"formFCMToken"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Token"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"FCM Token",onChange:function(e){return A(e.target.value)}})))),"filterRecipients"===G&&r.a.createElement("div",{className:"d-flex flex-row justify-content-space-between align-items-start"},r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(N.a,{id:"dropdown-hobby",title:"L\u1ecdc s\u1edf th\xedch",onSelect:function(e){return Z(e)}},Q.map((function(e,t){return r.a.createElement(D.a.Item,{eventKey:e,key:t},e)}))),r.a.createElement(N.a,{id:"dropdown-gender",style:{marginTop:10},title:"L\u1ecdc gi\u1edbi t\xednh",onSelect:function(e){return U(e)}},r.a.createElement(D.a.Item,{eventKey:"Nam"},"Nam"),r.a.createElement(D.a.Item,{eventKey:"N\u1eef"},"N\u1eef")),r.a.createElement(N.a,{id:"dropdown-ageRange",style:{marginTop:10,marginBottom:10},title:"L\u1ecdc \u0111\u1ed9 tu\u1ed5i",onSelect:function(e){return ne(e)}},r.a.createElement(D.a.Item,{eventKey:"0-25"},"0-25"),r.a.createElement(D.a.Item,{eventKey:"25-40"},"25-40"),r.a.createElement(D.a.Item,{eventKey:"40-55"},"40-55"),r.a.createElement(D.a.Item,{eventKey:"55-99"},"55-99"))),r.a.createElement("div",{style:{marginLeft:10}},r.a.createElement("div",{className:"d-flex flex-row align-items-center"},r.a.createElement("h6",null," ",le," valid users "),ue&&r.a.createElement(R.a,{animation:"grow"})),r.a.createElement("p",null,V&&r.a.createElement("em",null," c\xf3 s\u1edf th\xedch: ",V," ",r.a.createElement("br",null)),J&&r.a.createElement("em",null," c\xf3 gi\u1edbi t\xednh: ",J," ",r.a.createElement("br",null)),ae&&r.a.createElement("em",null," c\xf3 \u0111\u1ed9 tu\u1ed5i: ",ae," ")),r.a.createElement(b.a,{variant:"primary",onClick:function(e){Z(null),U(null),ne(null),ye(0)}},"Hu\u1ef7 l\u1ecdc")))),r.a.createElement("div",{style:{height:350,width:320,marginLeft:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement("fieldset",null,r.a.createElement(E.a.Group,{as:k.a},r.a.createElement(E.a.Label,{as:"legend",column:!0,sm:2},"K\u1ebf ho\u1ea1ch"),r.a.createElement(x.a,{sm:10},r.a.createElement(E.a.Check,{type:"radio",label:"Now",name:"scheduleOption",id:"now",onChange:Ae}),r.a.createElement(E.a.Check,{type:"radio",label:"Scheduled",name:"scheduleOption",id:"scheduled",onChange:Ae}),r.a.createElement(E.a.Check,{type:"radio",label:"Recurring",name:"scheduleOption",id:"recurring",onChange:Ae})))),"scheduled"===je&&r.a.createElement("div",{style:{marginBottom:20}},r.a.createElement(_.a,{onChange:function(e){xe(e)},value:ke})),r.a.createElement(T.a,{show:_e,onHide:function(){return Ge(!1)},size:"lg","aria-labelledby":"example-custom-modal-styling-title"},r.a.createElement(T.a.Header,{closeButton:!0},r.a.createElement(T.a.Title,{id:"example-custom-modal-styling-title"},"Recurring Builder")),r.a.createElement(T.a.Body,null,r.a.createElement(q.a,{cronExpression:Re,onChange:function(e){Te(e)},showResult:!0}))),"recurring"===je&&r.a.createElement("p",null,Re),r.a.createElement(L.a,{now:be}),(!be||"filterRecipients"!==G)&&r.a.createElement(b.a,{variant:"primary",onClick:function(){ye(100),We()},style:{marginTop:10}},"Send!")))}),K=function(e){e.history;var t=Object(n.useState)(!1),a=Object(g.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(g.a)(o,2),s=i[0],u=i[1],m=Object(n.useState)(!1),d=Object(g.a)(m,2),h=d[0],f=d[1],p=function(){l(!0),w.a.post("/fcm-cron",{action:"checkRunningTask"}).then((function(e){var t=e.data;l(!1),"scheduled"===t&&u(!0),"destroyed"!==t&&"null"!==t||u(!1)})).catch((function(e){console.log(e),f(!0)}))};Object(n.useEffect)((function(){p()}),[]);return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Cron Center"," "),r.a.createElement("h6",{className:"text-center"}," ","Cron latest post every 4 hours"," "),!h&&r.a.createElement("div",null,!s&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),w.a.post("/fcm-cron",{action:"start"}).then((function(e){return p()})).catch((function(e){return console.log(e)}))}},"Start"),s&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),w.a.post("/fcm-cron",{action:"destroy"}).then((function(e){return p()})).catch((function(e){return console.log(e)}))}},"STOP"),c&&r.a.createElement("p",null,"Checking if task is running..."))))},P=a(163),W=a(82),A=a.n(W),H=function(e){e.history;var t=Object(n.useState)([]),a=Object(g.a)(t,2),c=a[0],l=a[1],o=function(){w.a.post("/fcm-schedule-sender",{action:"getPlans"}).then((function(e){l(e.data)})).catch((function(e){return console.log(e)}))};Object(n.useEffect)((function(){o()}),[]);return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex flex-column justify-content-center align-items-center"},r.a.createElement("div",{style:{width:500}},r.a.createElement("h1",{className:"text-center"}," ","C\xe1c k\u1ebf ho\u1ea1ch \u0111\xe3 t\u1ea1o"," "),r.a.createElement("h6",{className:"text-center"}," ","Kh\xf4ng bao g\u1ed3m k\u1ebf ho\u1ea1ch \u0111\u01b0\u1ee3c g\u1eedi l\u1eadp t\u1ee9c"," ")),r.a.createElement(P.a,{variant:"flush"},c.map((function(e,t){var a,n,c=e.notificationData.title.slice(0,40)+"...",l=e.recipientData.recipientOption,i="singleRecipient"===l?"1 ng\u01b0\u1eddi":"filterRecipients"===l?"Nh\xf3m ng\u01b0\u1eddi ":"T\u1ea5t c\u1ea3",s=e.scheduleData.scheduleDateTime,u=e.scheduleData.scheduleRecurringExpression;return s&&(s=new Date(s)),a=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" "+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds(),u&&(n=A.a.toString(u)),r.a.createElement(P.a.Item,{key:t},r.a.createElement("div",{className:"d-flex flex-row justify-content-between align-items-center"},r.a.createElement("div",{className:"d-flex flex-column justify-content-between align-items-center"},r.a.createElement("em",null,"Ti\xeau \u0111\u1ec1: ",c||""),r.a.createElement("em",null,"\u0110\u1ed1i t\u01b0\u1ee3ng nh\u1eadn: ",i||""),r.a.createElement("em",null,"scheduled"===e.scheduleData.scheduleOption?"G\u1eedi theo l\u1ecbch: "+a:""),r.a.createElement("em",null,"recurring"===e.scheduleData.scheduleOption?"G\u1eedi l\u1eb7p l\u1ea1i: "+n:"")),r.a.createElement(b.a,{style:{marginLeft:10},variant:"danger",onClick:function(e){var a;a=t,w.a.post("/fcm-schedule-sender",{action:"deletePlan",deletePlanIndex:a}).then((function(e){o()})).catch((function(e){return console.log(e)}))}},"Xo\xe1")))}))))},M=a(89),J=function(e){var t=e.component,a=Object(M.a)(e,["component"]),c=Object(n.useContext)(y).auth;return c.loading?r.a.createElement(d.b,Object.assign({},a,{render:function(){return r.a.createElement("p",null,"Loading...")}})):r.a.createElement(d.b,Object.assign({},a,{render:function(e){return c.data?r.a.createElement(t,e):r.a.createElement(d.a,{to:"/sign-in"})}}))},U=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/sign-in",component:C}),r.a.createElement(J,{path:"/notification-cron",component:K}),r.a.createElement(J,{path:"/schedule-history",component:H}),r.a.createElement(J,{path:"/notification-sender",component:B}),r.a.createElement(J,{path:"/",component:S})))}}]),a}(n.Component),F=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(r.a.createElement(v,null,r.a.createElement(U,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");F?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):z(e)}))}}()},91:function(e,t,a){e.exports=a(152)},96:function(e,t,a){},97:function(e,t,a){}},[[91,1,2]]]);
//# sourceMappingURL=main.906560e7.chunk.js.map