(this.webpackJsonpmy_react_app=this.webpackJsonpmy_react_app||[]).push([[0],{151:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),l=a.n(c),o=(a(95),a(73)),i=a(74),s=a(87),u=a(85),m=(a(96),a(97),a(53)),d=a(23),h=a(27),f=a.n(h),p=a(39),g=a(7),E=a(161),b=a(77),v=Object(n.createContext)({}),y=function(e){var t=e.children,a=Object(n.useState)({loading:!0,data:null}),c=Object(g.a)(a,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){o({loading:!1,data:JSON.parse(window.localStorage.getItem("authData"))})}),[]),Object(n.useEffect)((function(){window.localStorage.setItem("authData",JSON.stringify(l.data))}),[l.data]),r.a.createElement(v.Provider,{value:{auth:l,setAuthData:function(e){o({data:e})}}},t)},j="https://app.baomoi.press/wp-json/wp/v2/",O=a(11),w=a.n(O),k=function(e){var t=e.history,a=Object(n.useState)(),c=Object(g.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(),s=Object(g.a)(i,2),u=s[0],m=s[1],d=Object(n.useContext)(v).setAuthData,h=function(){var e=Object(p.a)(f.a.mark((function e(a){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,y();case 3:if(n=e.sent,r=null,!n){e.next=9;break}return e.next=8,O(n);case 8:r=e.sent;case 9:r&&(d({username:l}),t.replace("/"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){return w.a.post("https://app.baomoi.press/wp-json/jwt-auth/v1/token",{username:l,password:u}).then((function(e){return e.data.token})).catch((function(e){alert("Username or password is invalid!")}))},O=function(e){return w()({method:"GET",url:j+"current_user",headers:{Authorization:"Bearer "+e}}).then((function(e){return"administrator"===e.data.roles[0]||(alert("You are not allowed to access"),!1)})).catch((function(e){return!1}))};return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:400}},r.a.createElement("h2",{className:"text-center"},"B\xe1o m\u1edbi Press Notification"),r.a.createElement("h4",{className:"text-center"},"\u0110\u0103ng nh\u1eadp"),r.a.createElement(E.a,{onSubmit:h},r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Username"),r.a.createElement(E.a.Control,{type:"username",placeholder:"Enter username",onChange:function(e){o(e.target.value)}})),r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Password"),r.a.createElement(E.a.Control,{type:"password",placeholder:"Password",onChange:function(e){m(e.target.value)}})),r.a.createElement(b.a,{variant:"primary",type:"submit",className:"w-100 mt-3"},"Sign In as Admin"))))},C=function(e){var t=e.history,a=Object(n.useContext)(v),c=a.setAuthData,l=a.auth;return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Hello, ".concat(l.data.username)," "),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-sender")}},"G\u1eedi th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-cron")}},"Cron th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-5",onClick:function(){c(null)}},"Log out")))},S=a(57),x=a(157),N=a(76),I=a(158),L=a(47),T=a(159),R=a(160),_=a(163),D=a(78),q=a.n(D),B=a(79),G=a.n(B),K=(a(145),function(e){var t=e.history,a=Object(n.useState)(),c=Object(g.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(),s=Object(g.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(),h=Object(g.a)(d,2),v=h[0],y=h[1],O=Object(n.useState)(),k=Object(g.a)(O,2),C=k[0],D=k[1],B=Object(n.useState)(),K=Object(g.a)(B,2),A=K[0],W=K[1],M=Object(n.useState)(),H=Object(g.a)(M,2),P=H[0],U=H[1],J=Object(n.useState)(),F=Object(g.a)(J,2),X=F[0],z=F[1],Y=Object(n.useState)(),Q=Object(g.a)(Y,2),$=Q[0],V=Q[1],Z=Object(n.useState)(),ee=Object(g.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),re=Object(g.a)(ne,2),ce=re[0],le=re[1],oe=Object(n.useState)(!1),ie=Object(g.a)(oe,2),se=ie[0],ue=ie[1],me=Object(n.useState)(),de=Object(g.a)(me,2),he=de[0],fe=de[1],pe=Object(n.useState)(0),ge=Object(g.a)(pe,2),Ee=ge[0],be=ge[1],ve=Object(n.useState)(),ye=Object(g.a)(ve,2),je=ye[0],Oe=ye[1],we=Object(n.useState)(new Date),ke=Object(g.a)(we,2),Ce=ke[0],Se=ke[1],xe=Object(n.useState)("* * * * * * *"),Ne=Object(g.a)(xe,2),Ie=Ne[0],Le=Ne[1],Te=Object(n.useState)(!1),Re=Object(g.a)(Te,2),_e=Re[0],De=Re[1],qe=Object(n.useRef)(!0);Object(n.useLayoutEffect)((function(){qe.current?qe.current=!1:(ue(!0),Ge())}),[$,X,te]);var Be=function(e){W(e.target.id)},Ge=function(){var e="",t="",a="",n=0;X&&(e="&filter[meta_query]["+n+"][key]=gender&filter[meta_query]["+n+"][value]="+X.toString(),n++),$&&(t="&filter[meta_query]["+n+"][key]=so_thich&filter[meta_query]["+n+"][value]="+$.toString(),n++),te&&(a=(a="&filter[meta_query]["+n+"][key]=age&filter[meta_query]["+n+"][value]="+te.split("-")[0]+"&filter[meta_query]["+n+"][compare]=>")+"&filter[meta_query]["+ ++n+"][key]=age&filter[meta_query]["+n+"][value]="+te.split("-")[1]+"&filter[meta_query]["+n+"][compare]=<="),fe(e+t+a),w.a.get("https://app.baomoi.press/wp-json/wp/v2/users?per_page=1"+e+t+a).then((function(e){le(e.headers["x-wp-total"]),ue(!1)})).catch((function(e){console.log(e)}))},Ke=function(){We([P]),be(100)},Ae=function(){var e=Object(p.a)(f.a.mark((function e(){var t,a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ce){e.next=10;break}t=0;case 2:if(!(t<=ce/1e3)){e.next=10;break}for(a=[],n=10*t+1;n<=10*t+10;n++)r=j+"users?per_page=100&page="+n.toString()+he,a.push(w.a.get(r));return e.next=7,w.a.all(a).then((function(e){var a=[];e.forEach((function(e){if(e.data.length){var t=e.data.map((function(e){return e.acf.fcmToken}));a=[].concat(Object(S.a)(a),Object(S.a)(t))}})),be((t+1)/(ce/1e3+1)*100),We(a)}));case 7:t++,e.next=2;break;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(e,t){var a={dateTime:Ce,recurringExpression:Ie};w.a.post("/fcm-schedule-sender",{data:{title:l,body:u,slug:C||"",image:v||"",tokens:e.toString(),topics:t||"",scheduleAction:je,scheduleData:a}}).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))},Me=function(e){Oe(e.target.id),"recurring"===e.target.id&&De(!0)};return r.a.createElement("div",{style:{height:"100vh",marginTop:10},className:"d-flex flex-row justify-content-center align-items-center"},r.a.createElement("div",{style:{position:"absolute",top:20,right:20}},r.a.createElement(b.a,{variant:"link",onClick:function(){t.push("/schedule-history")}},"L\u1ecbch s\u1eed k\u1ebf ho\u1ea1ch >>")),r.a.createElement("div",{style:{height:350,width:320,marginRight:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement(E.a,null,r.a.createElement(E.a.Group,{as:x.a,controlId:"formTitle"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Title"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{required:!0,type:"text",placeholder:"Title",onChange:function(e){return o(e.target.value)}}))),r.a.createElement(E.a.Group,{controlId:"formBody"},r.a.createElement(E.a.Label,null,"Body"),r.a.createElement(E.a.Control,{required:!0,as:"textarea",rows:"3",placeholder:"Body",onChange:function(e){return m(e.target.value)}})),r.a.createElement(E.a.Group,{as:x.a,controlId:"formImageURL"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Image"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Image Url(not required)",onChange:function(e){return y(e.target.value)}}))),r.a.createElement(E.a.Group,{as:x.a,controlId:"formSlugData"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Slug"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Slug Data(not required)",onChange:function(e){return D(e.target.value)}}))))),r.a.createElement("div",{style:{height:350,width:320,marginLeft:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement("fieldset",null,r.a.createElement(E.a.Group,{as:x.a},r.a.createElement(E.a.Label,{as:"legend",column:!0,sm:2},"G\u1eedi cho"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Check,{type:"radio",label:"M\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"singleRecipient",onChange:Be}),r.a.createElement(E.a.Check,{type:"radio",label:"Nh\xf3m \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"filterRecipients",onChange:Be}),r.a.createElement(E.a.Check,{type:"radio",label:"T\u1ea5t c\u1ea3",name:"recipientOption",id:"allRecipients",onChange:Be})))),"singleRecipient"===A&&r.a.createElement(E.a,{onSubmit:Ke},r.a.createElement(E.a.Group,{as:x.a,controlId:"formFCMToken"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Token"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"FCM Token",onChange:function(e){return U(e.target.value)}})))),"filterRecipients"===A&&r.a.createElement("div",{className:"d-flex flex-row justify-content-space-between align-items-start"},r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(I.a,{id:"dropdown-hobby",title:"L\u1ecdc s\u1edf th\xedch",onSelect:function(e){return V(e)}},r.a.createElement(L.a.Item,{eventKey:"C\xe0 ph\xea"},"C\xe0 ph\xea"),r.a.createElement(L.a.Item,{eventKey:"Nghe nh\u1ea1c"},"Nghe nh\u1ea1c"),r.a.createElement(L.a.Item,{eventKey:"Xem phim"},"Xem phim"),r.a.createElement(L.a.Item,{eventKey:"\u0110\xe1 b\xf3ng"},"\u0110\xe1 b\xf3ng")),r.a.createElement(I.a,{id:"dropdown-gender",style:{marginTop:10},title:"L\u1ecdc gi\u1edbi t\xednh",onSelect:function(e){return z(e)}},r.a.createElement(L.a.Item,{eventKey:"Nam"},"Nam"),r.a.createElement(L.a.Item,{eventKey:"N\u1eef"},"N\u1eef")),r.a.createElement(I.a,{id:"dropdown-ageRange",style:{marginTop:10,marginBottom:10},title:"L\u1ecdc \u0111\u1ed9 tu\u1ed5i",onSelect:function(e){return ae(e)}},r.a.createElement(L.a.Item,{eventKey:"0-25"},"0-25"),r.a.createElement(L.a.Item,{eventKey:"25-40"},"25-40"),r.a.createElement(L.a.Item,{eventKey:"40-55"},"40-55"),r.a.createElement(L.a.Item,{eventKey:"55-99"},"55-99"))),r.a.createElement("div",{style:{marginLeft:10}},r.a.createElement("div",{className:"d-flex flex-row align-items-center"},r.a.createElement("h6",null," ",ce," valid users "),se&&r.a.createElement(T.a,{animation:"grow"})),r.a.createElement("p",null,$&&r.a.createElement("em",null," c\xf3 s\u1edf th\xedch: ",$," ",r.a.createElement("br",null)),X&&r.a.createElement("em",null," c\xf3 gi\u1edbi t\xednh: ",X," ",r.a.createElement("br",null)),te&&r.a.createElement("em",null," c\xf3 \u0111\u1ed9 tu\u1ed5i: ",te," ")),r.a.createElement(b.a,{variant:"primary",onClick:function(e){V(null),z(null),ae(null),be(0)}},"Hu\u1ef7 l\u1ecdc")))),r.a.createElement("div",{style:{height:350,width:320,marginLeft:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement("fieldset",null,r.a.createElement(E.a.Group,{as:x.a},r.a.createElement(E.a.Label,{as:"legend",column:!0,sm:2},"K\u1ebf ho\u1ea1ch"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Check,{type:"radio",label:"Now",name:"scheduleOption",id:"now",onChange:Me}),r.a.createElement(E.a.Check,{type:"radio",label:"Scheduled",name:"scheduleOption",id:"scheduled",onChange:Me}),r.a.createElement(E.a.Check,{type:"radio",label:"Recurring",name:"scheduleOption",id:"recurring",onChange:Me})))),"scheduled"===je&&r.a.createElement("div",{style:{marginBottom:20}},r.a.createElement(q.a,{onChange:function(e){Se(e)},value:Ce})),r.a.createElement(R.a,{show:_e,onHide:function(){return De(!1)},size:"lg","aria-labelledby":"example-custom-modal-styling-title"},r.a.createElement(R.a.Header,{closeButton:!0},r.a.createElement(R.a.Title,{id:"example-custom-modal-styling-title"},"Recurring Builder Modal")),r.a.createElement(R.a.Body,null,r.a.createElement(G.a,{cronExpression:Ie,onChange:function(e){Le(e)},showResult:!0}))),"recurring"===je&&r.a.createElement("p",null,Ie),r.a.createElement(_.a,{now:Ee}),(!Ee||"filterRecipients"!==A)&&r.a.createElement(b.a,{variant:"primary",onClick:function(){"singleRecipient"===A&&Ke(),"filterRecipients"===A&&Ae(),"allRecipients"===A&&(We([],"news"),be(100))},style:{marginTop:10}},"Send!")))}),A=function(e){e.history;var t=Object(n.useState)(!1),a=Object(g.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(g.a)(o,2),s=i[0],u=i[1],m=Object(n.useState)(!1),d=Object(g.a)(m,2),h=d[0],f=d[1],p=function(){l(!0),w.a.post("/fcm-cron",{action:"checkRunningTask"}).then((function(e){var t=e.data;l(!1),"scheduled"===t&&u(!0),"destroyed"!==t&&"null"!==t||u(!1)})).catch((function(e){console.log(e),f(!0)}))};Object(n.useEffect)((function(){p()}),[]);return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Cron Center"," "),r.a.createElement("h6",{className:"text-center"}," ","Cron latest post every 4 hours"," "),!h&&r.a.createElement("div",null,!s&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),w.a.post("/fcm-cron",{action:"start"}).then((function(e){return p()})).catch((function(e){return console.log(e)}))}},"Start"),s&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),w.a.post("/fcm-cron",{action:"destroy"}).then((function(e){return p()})).catch((function(e){return console.log(e)}))}},"STOP"),c&&r.a.createElement("p",null,"Checking if task is running..."))))},W=a(162),M=a(81),H=a.n(M),P=function(e){e.history;var t=Object(n.useState)([]),a=Object(g.a)(t,2),c=a[0],l=a[1],o=function(){w.a.post("/fcm-schedule-sender",{data:{scheduleAction:"checkCurrentTasks",scheduleData:{}}}).then((function(e){l(e.data)})).catch((function(e){return console.log(e)}))};Object(n.useEffect)((function(){o()}),[]);return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex flex-column justify-content-center align-items-center"},r.a.createElement("div",{style:{width:500}},r.a.createElement("h1",{className:"text-center"}," ","C\xe1c k\u1ebf ho\u1ea1ch \u0111\xe3 t\u1ea1o"," "),r.a.createElement("h6",{className:"text-center"}," ","Kh\xf4ng bao g\u1ed3m k\u1ebf ho\u1ea1ch \u0111\u01b0\u1ee3c g\u1eedi l\u1eadp t\u1ee9c"," ")),r.a.createElement(W.a,{variant:"flush"},c.map((function(e,t){var a,n,c=e.scheduleData.dateTime,l=e.scheduleData.recurringExpression;return c&&(a=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()),l&&(n=H.a.toString(l)),r.a.createElement(W.a.Item,{key:t},r.a.createElement("div",{className:"d-flex flex-row justify-content-between align-items-center"},r.a.createElement("div",{className:"d-flex flex-column justify-content-between align-items-center"},r.a.createElement("em",null,"N\u1ed9i dung ti\xeau \u0111\u1ec1: ",e.title||""),r.a.createElement("em",null,"scheduled"===e.scheduleAction?a:""),r.a.createElement("em",null,"recurring"===e.scheduleAction?n:"")),r.a.createElement(b.a,{style:{marginLeft:10},variant:"danger",onClick:function(e){var a;a=t,w.a.post("/fcm-schedule-sender",{data:{scheduleAction:"deleteTask",scheduleData:{deleteTaskIndex:a}}}).then((function(e){o()})).catch((function(e){return console.log(e)}))}},"Xo\xe1")))}))))},U=a(88),J=function(e){var t=e.component,a=Object(U.a)(e,["component"]),c=Object(n.useContext)(v).auth;return c.loading?r.a.createElement(d.b,Object.assign({},a,{render:function(){return r.a.createElement("p",null,"Loading...")}})):r.a.createElement(d.b,Object.assign({},a,{render:function(e){return c.data?r.a.createElement(t,e):r.a.createElement(d.a,{to:"/sign-in"})}}))},F=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/sign-in",component:k}),r.a.createElement(J,{path:"/notification-cron",component:A}),r.a.createElement(J,{path:"/schedule-history",component:P}),r.a.createElement(J,{path:"/notification-sender",component:K}),r.a.createElement(J,{path:"/",component:C})))}}]),a}(n.Component),X=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(r.a.createElement(y,null,r.a.createElement(F,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");X?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):z(e)}))}}()},90:function(e,t,a){e.exports=a(151)},95:function(e,t,a){},96:function(e,t,a){}},[[90,1,2]]]);
//# sourceMappingURL=main.6f4c2ff5.chunk.js.map