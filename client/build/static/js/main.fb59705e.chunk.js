(this.webpackJsonpmy_react_app=this.webpackJsonpmy_react_app||[]).push([[0],{62:function(e,t,a){e.exports=a(95)},67:function(e,t,a){},68:function(e,t,a){},95:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),o=a.n(c),l=(a(67),a(45)),i=a(46),u=a(60),s=a(59),m=(a(68),a(69),a(30)),f=a(13),p=a(15),d=a.n(p),h=a(22),g=a(6),E=a(102),b=a(49),v=Object(n.createContext)({}),y=function(e){var t=e.children,a=Object(n.useState)({loading:!0,data:null}),c=Object(g.a)(a,2),o=c[0],l=c[1];return Object(n.useEffect)((function(){l({loading:!1,data:JSON.parse(window.localStorage.getItem("authData"))})}),[]),Object(n.useEffect)((function(){window.localStorage.setItem("authData",JSON.stringify(o.data))}),[o.data]),r.a.createElement(v.Provider,{value:{auth:o,setAuthData:function(e){l({data:e})}}},t)},j="https://app.baomoi.press/wp-json/wp/v2/",w=a(9),O=a.n(w),C=function(e){var t=e.history,a=Object(n.useState)(),c=Object(g.a)(a,2),o=c[0],l=c[1],i=Object(n.useState)(),u=Object(g.a)(i,2),s=u[0],m=u[1],f=Object(n.useContext)(v).setAuthData,p=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,y();case 3:if(n=e.sent,r=null,!n){e.next=9;break}return e.next=8,w(n);case 8:r=e.sent;case 9:r&&(f({username:o}),t.replace("/"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){return O.a.post("https://app.baomoi.press/wp-json/jwt-auth/v1/token",{username:o,password:s}).then((function(e){return e.data.token})).catch((function(e){alert("Username or password is invalid!")}))},w=function(e){return O()({method:"GET",url:j+"current_user",headers:{Authorization:"Bearer "+e}}).then((function(e){return"administrator"===e.data.roles[0]||(alert("You are not allowed to access"),!1)})).catch((function(e){return!1}))};return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:400}},r.a.createElement("h2",{className:"text-center"},"B\xe1o m\u1edbi Press Notification"),r.a.createElement("h4",{className:"text-center"},"\u0110\u0103ng nh\u1eadp"),r.a.createElement(E.a,{onSubmit:p},r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Username"),r.a.createElement(E.a.Control,{type:"username",placeholder:"Enter username",onChange:function(e){l(e.target.value)}})),r.a.createElement(E.a.Group,null,r.a.createElement(E.a.Label,null,"Password"),r.a.createElement(E.a.Control,{type:"password",placeholder:"Password",onChange:function(e){m(e.target.value)}})),r.a.createElement(b.a,{variant:"primary",type:"submit",className:"w-100 mt-3"},"Sign In as Admin"))))},S=function(e){var t=e.history,a=Object(n.useContext)(v),c=a.setAuthData,o=a.auth;return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Hello, ".concat(o.data.username)," "),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-sender")}},"G\u1eedi th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(){t.push("/notification-cron")}},"Cron th\xf4ng b\xe1o"),r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-5",onClick:function(){c(null)}},"Log out")))},k=a(33),x=a(99),N=a(48),I=a(100),L=a(26),_=a(101),T=a(103),R=function(){var e=Object(n.useState)(),t=Object(g.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(),l=Object(g.a)(o,2),i=l[0],u=l[1],s=Object(n.useState)(),m=Object(g.a)(s,2),f=m[0],p=m[1],v=Object(n.useState)(),y=Object(g.a)(v,2),w=y[0],C=y[1],S=Object(n.useState)(),R=Object(g.a)(S,2),q=R[0],D=R[1],G=Object(n.useState)(),K=Object(g.a)(G,2),B=K[0],W=K[1],A=Object(n.useState)(),P=Object(g.a)(A,2),U=P[0],J=P[1],M=Object(n.useState)(),F=Object(g.a)(M,2),H=F[0],X=F[1],z=Object(n.useState)(),Q=Object(g.a)(z,2),Y=Q[0],$=Q[1],V=Object(n.useState)(0),Z=Object(g.a)(V,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(!1),ne=Object(g.a)(ae,2),re=ne[0],ce=ne[1],oe=Object(n.useState)(),le=Object(g.a)(oe,2),ie=le[0],ue=le[1],se=Object(n.useState)(0),me=Object(g.a)(se,2),fe=me[0],pe=me[1],de=Object(n.useRef)(!0);Object(n.useLayoutEffect)((function(){de.current?de.current=!1:(ce(!0),ge())}),[H,U,Y]);var he=function(e){D(e.target.id)},ge=function(){var e="",t="",a="",n=0;U&&(e="&filter[meta_query]["+n+"][key]=gender&filter[meta_query]["+n+"][value]="+U.toString(),n++),H&&(t="&filter[meta_query]["+n+"][key]=so_thich&filter[meta_query]["+n+"][value]="+H.toString(),n++),Y&&(a=(a="&filter[meta_query]["+n+"][key]=age&filter[meta_query]["+n+"][value]="+Y.split("-")[0]+"&filter[meta_query]["+n+"][compare]=>")+"&filter[meta_query]["+ ++n+"][key]=age&filter[meta_query]["+n+"][value]="+Y.split("-")[1]+"&filter[meta_query]["+n+"][compare]=<="),ue(e+t+a),O.a.get("https://app.baomoi.press/wp-json/wp/v2/users?per_page=1"+e+t+a).then((function(e){te(e.headers["x-wp-total"]),ce(!1)})).catch((function(e){console.log(e)}))},Ee=function(){var e=Object(h.a)(d.a.mark((function e(t){var a,n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!ee){e.next=11;break}a=0;case 3:if(!(a<=ee/1e3)){e.next=11;break}for(n=[],r=10*a+1;r<=10*a+10;r++)c=j+"users?per_page=100&page="+r.toString()+ie,n.push(O.a.get(c));return e.next=8,O.a.all(n).then((function(e){var t=[];e.forEach((function(e){if(e.data.length){var a=e.data.map((function(e){return e.acf.fcmToken}));t=[].concat(Object(k.a)(t),Object(k.a)(a))}})),pe((a+1)/(ee/1e3+1)*100),be(t)}));case 8:a++,e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(e,t){console.log(a),O.a.post("/fcm-sender",{title:a,body:i,slug:w||"",image:f||"",tokens:e.toString(),topics:t||""}).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))};return r.a.createElement("div",{style:{height:"100vh",marginTop:10},className:"d-flex flex-row justify-content-center align-items-center"},r.a.createElement("div",{style:{height:350,width:320,marginRight:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement(E.a,null,r.a.createElement(E.a.Group,{as:x.a,controlId:"formTitle"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Title"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{required:!0,type:"text",placeholder:"Title",onChange:function(e){return c(e.target.value)}}))),r.a.createElement(E.a.Group,{controlId:"formBody"},r.a.createElement(E.a.Label,null,"Body"),r.a.createElement(E.a.Control,{required:!0,as:"textarea",rows:"3",placeholder:"Body",onChange:function(e){return u(e.target.value)}})),r.a.createElement(E.a.Group,{as:x.a,controlId:"formImageURL"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Image"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Image Url(not required)",onChange:function(e){return p(e.target.value)}}))),r.a.createElement(E.a.Group,{as:x.a,controlId:"formSlugData"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Slug"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"Slug Data(not required)",onChange:function(e){return C(e.target.value)}}))))),r.a.createElement("div",{style:{height:350,width:320,marginLeft:20,borderStyle:"ridge",borderWidth:1,borderRadius:10,padding:20,overflow:"scroll"}},r.a.createElement("fieldset",null,r.a.createElement(E.a.Group,{as:x.a},r.a.createElement(E.a.Label,{as:"legend",column:!0,sm:2},"G\u1eedi theo"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Check,{type:"radio",label:"M\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"singleRecipient",onChange:he}),r.a.createElement(E.a.Check,{type:"radio",label:"Nh\xf3m \u0111\u1ed1i t\u01b0\u1ee3ng",name:"recipientOption",id:"filterRecipients",onChange:he}),r.a.createElement(E.a.Check,{type:"radio",label:"T\u1ea5t c\u1ea3",name:"recipientOption",id:"allRecipients",onChange:he})))),"singleRecipient"===q&&r.a.createElement(E.a,{onSubmit:function(e){e.preventDefault(),be([B])}},r.a.createElement(E.a.Group,{as:x.a,controlId:"formFCMToken"},r.a.createElement(E.a.Label,{column:!0,sm:2},"Token"),r.a.createElement(N.a,{sm:10},r.a.createElement(E.a.Control,{type:"text",placeholder:"FCM Token",onChange:function(e){return W(e.target.value)}}))),r.a.createElement(b.a,{variant:"primary",type:"submit"},"Send!")),"filterRecipients"===q&&r.a.createElement("div",{className:"d-flex flex-row justify-content-space-between align-items-start"},r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(I.a,{id:"dropdown-hobby",title:"L\u1ecdc s\u1edf th\xedch",onSelect:function(e){return X(e)}},r.a.createElement(L.a.Item,{eventKey:"C\xe0 ph\xea"},"C\xe0 ph\xea"),r.a.createElement(L.a.Item,{eventKey:"Nghe nh\u1ea1c"},"Nghe nh\u1ea1c"),r.a.createElement(L.a.Item,{eventKey:"Xem phim"},"Xem phim"),r.a.createElement(L.a.Item,{eventKey:"\u0110\xe1 b\xf3ng"},"\u0110\xe1 b\xf3ng")),r.a.createElement(I.a,{id:"dropdown-gender",style:{marginTop:10},title:"L\u1ecdc gi\u1edbi t\xednh",onSelect:function(e){return J(e)}},r.a.createElement(L.a.Item,{eventKey:"Nam"},"Nam"),r.a.createElement(L.a.Item,{eventKey:"N\u1eef"},"N\u1eef")),r.a.createElement(I.a,{id:"dropdown-ageRange",style:{marginTop:10,marginBottom:10},title:"L\u1ecdc \u0111\u1ed9 tu\u1ed5i",onSelect:function(e){return $(e)}},r.a.createElement(L.a.Item,{eventKey:"0-25"},"0-25"),r.a.createElement(L.a.Item,{eventKey:"25-40"},"25-40"),r.a.createElement(L.a.Item,{eventKey:"40-55"},"40-55"),r.a.createElement(L.a.Item,{eventKey:"55-99"},"55-99")),r.a.createElement(b.a,{variant:"primary",onClick:function(e){X(null),J(null),$(null),pe(0)}},"Hu\u1ef7 l\u1ecdc")),r.a.createElement("div",{style:{marginLeft:10}},r.a.createElement("div",{className:"d-flex flex-row align-items-center"},r.a.createElement("h6",null," ",ee," valid users "),re&&r.a.createElement(_.a,{animation:"grow"})),r.a.createElement("p",null,H&&r.a.createElement("em",null," c\xf3 s\u1edf th\xedch: ",H," ",r.a.createElement("br",null)),U&&r.a.createElement("em",null," c\xf3 gi\u1edbi t\xednh: ",U," ",r.a.createElement("br",null)),Y&&r.a.createElement("em",null," c\xf3 \u0111\u1ed9 tu\u1ed5i: ",Y," ")),r.a.createElement(T.a,{now:fe}),!fe&&r.a.createElement(b.a,{variant:"primary",onClick:Ee,style:{marginTop:10}},"Send!"))),"allRecipients"===q&&r.a.createElement(b.a,{variant:"primary",onClick:function(e){e.preventDefault(),be([],"news")}},"Send all!")))},q=function(e){e.history;var t=Object(n.useState)(!1),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),i=Object(g.a)(l,2),u=i[0],s=i[1],m=Object(n.useState)(!1),f=Object(g.a)(m,2),p=f[0],d=f[1],h=function(){o(!0),O.a.post("/fcm-cron",{action:"checkRunningTask"}).then((function(e){var t=e.data;o(!1),"scheduled"===t&&s(!0),"destroyed"!==t&&"null"!==t||s(!1)})).catch((function(e){console.log(e),d(!0)}))};Object(n.useEffect)((function(){h()}),[]);return r.a.createElement("div",{style:{height:"100vh"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",{style:{width:300}},r.a.createElement("h1",{className:"text-center"}," ","Cron Center"," "),r.a.createElement("h6",{className:"text-center"}," ","Cron latest post every 4 hours"," "),!p&&r.a.createElement("div",null,!u&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),O.a.post("/fcm-cron",{action:"start"}).then((function(e){return h()})).catch((function(e){return console.log(e)}))}},"Start"),u&&r.a.createElement(b.a,{variant:"primary",type:"button",className:"w-100 mt-3",onClick:function(e){e.preventDefault(),O.a.post("/fcm-cron",{action:"destroy"}).then((function(e){return h()})).catch((function(e){return console.log(e)}))}},"STOP"),c&&r.a.createElement("p",null,"Checking if task is running..."))))},D=a(61),G=function(e){var t=e.component,a=Object(D.a)(e,["component"]),c=Object(n.useContext)(v).auth;return c.loading?r.a.createElement(f.b,Object.assign({},a,{render:function(){return r.a.createElement("p",null,"Loading...")}})):r.a.createElement(f.b,Object.assign({},a,{render:function(e){return c.data?r.a.createElement(t,e):r.a.createElement(f.a,{to:"/sign-in"})}}))},K=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/sign-in",component:C}),r.a.createElement(G,{path:"/notification-cron",component:q}),r.a.createElement(G,{path:"/notification-sender",component:R}),r.a.createElement(G,{path:"/",component:S})))}}]),a}(n.Component),B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function W(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(y,null,r.a.createElement(K,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");B?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):W(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):W(e)}))}}()}},[[62,1,2]]]);
//# sourceMappingURL=main.fb59705e.chunk.js.map